<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Ajout Salary Structure Assignment</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body>
<div th:replace="~{fragments/header}"></div>

<div class="main-content">
    <div class="container mt-5">
        <div class="card">
            <div class="card-header">
                <h4 th:text="${isEdit != null and isEdit} ? 'Modifier le Bulletin de Salaire' : 'Nouveaux Bulletins de Salaire'"></h4>
            </div>

            <div class="card-body">
                <div th:if="${success}" class="alert alert-success" role="alert">
                    <span th:text="${success}"></span>
                    <span th:if="${slipName}">Référence: <strong th:text="${slipName}"></strong></span>
                </div>

                <div th:if="${error}" class="alert alert-danger" role="alert">
                    <span th:text="${error}"></span>
                </div>

                <form th:action="@{/exo/create-salary-assignment-date}" method="post">
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label for="employee" class="form-label">Employé</label>
                            <select class="form-select" id="employee" name="employee" required>
                                <option value="">Sélectionner un employé</option>
                                <option th:each="emp : ${employees}"
                                        th:value="${emp['name'] + '|' + emp['employee_name']}"
                                        th:text="${emp['employee_name'] + ' (' + emp['name'] + ')'}">
                                </option>
                            </select>
                        </div>

                        <div class="col-md-3">
                            <label for="employee" class="form-label">Structure Salaire</label>
                            <select class="form-select" id="salary_structure" name="salaryStructure" required>
                                <option value="">Sélectionner un structure</option>
                                <option th:each="salary_structure : ${salary_structures}"
                                        th:value="${salary_structure['name']}"
                                        th:text="${salary_structure['name'] }">
                                </option>
                            </select>
                        </div>
                    </div>
                    <h4>Salaire Structure Assignment</h4>
                    <table class="table" id="structuresTable">
                        <thead>
                        <tr>
                            <th>Montant</th>
                            <th>Annee</th>
                            <th>Mois</th>
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody id="structureBody">
                        <tr>
                            <td><input type="number" step="0.01" class="form-control" id="baseAmount"
                                       name="baseAmount"></td>
                            <td><input type="number" name="annee" class="form-control" required></td>
                            <td>
                                <select class="form-select" name="mois" >
                                    <option value="01">Janvier</option>
                                    <option value="02">Février</option>
                                    <option value="03">Mars</option>
                                    <option value="04">Avril</option>
                                    <option value="05">Mai</option>
                                    <option value="06">Juin</option>
                                    <option value="07">Juillet</option>
                                    <option value="08">Août</option>
                                    <option value="09">Septembre</option>
                                    <option value="10">Octobre</option>
                                    <option value="11">Novembre</option>
                                    <option value="12">Décembre</option>
                                </select>
                            </td>
                            <td><button type="button" class="btn btn-danger" onclick="removeRow(this)">Supprimer</button></td>
                        </tr>
                        </tbody>
                    </table>
                    <button type="button" class="btn btn-secondary" onclick="addRow()">Ajouter un Salaire Structure Assignment</button>


                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="submit" class="btn btn-primary">
                            Creer
                        </button>
                        <a th:href="@{/accueil}" class="btn btn-secondary">Annuler</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    let itemIndex = 1;
    function addRow() {
        const row = ` <tr>
                        <td><input type="number" step="0.01" class="form-control" id="baseAmount"
                                       name="baseAmount"></td>
                            <td><input type="number" name="annee" class="form-control" required></td>
                            <td>
                                <select class="form-select" name="mois" >
                                    <option value="01">Janvier</option>
                                    <option value="02">Février</option>
                                    <option value="03">Mars</option>
                                    <option value="04">Avril</option>
                                    <option value="05">Mai</option>
                                    <option value="06">Juin</option>
                                    <option value="07">Juillet</option>
                                    <option value="08">Août</option>
                                    <option value="09">Septembre</option>
                                    <option value="10">Octobre</option>
                                    <option value="11">Novembre</option>
                                    <option value="12">Décembre</option>
                                </select>
                            </td>
                            <td><button type="button" class="btn btn-danger" onclick="removeRow(this)">Supprimer</button></td>
                        </tr>`;

        $('#structureBody').append(row);
        itemIndex++;
    }

    function removeRow(button) {
        $(button).closest('tr').remove();
    }
</script>

<div th:replace="~{fragments/footer}"></div>


</body>
</html>